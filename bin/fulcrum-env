#!/bin/bash

set -e

export FULCRUM_COMPOSE_FILE="~/fulcrum/compose/docker-compose.yml"

export FULCRUM_UNAME_A=$(uname -a)
export FULCRUM_DOCKER_PREFIX="sudo "
export FULCRUM_DOCKER_SUFIX=""
export FULCRUM_PATH=/usr/local/fulcrum
export FULCRUM_REPOS_PATH=/usr/local/repos
export FULCRUM_TMP_DIR=/sfs/other/tmp
export FULCRUM_DOCKER_COMPOSE="sudo /usr/local/bin/docker-compose"

# OSX
if [[ "$FULCRUM_UNAME_A" == *"Darwin"* ]]; then
  export FULCRUM_DOCKER_PREFIX=""
  export FULCRUM_DOCKER_SUFIX=""
  export FULCRUM_PATH=/Users/$USER/fulcrum
  export FULCRUM_REPOS_PATH=/Users/$USER/repos
  export FULCRUM_TMP_DIR=/tmp
# DockerRoot
elif [[ "$FULCRUM_UNAME_A" == *"docker-root"* ]]; then
  export FULCRUM_HOST_USER=$(mount|grep nfs|cut -d\  -f1|cut -d/ -f3)
  export FULCRUM_HOST_UID=$(stat -c %u /Users/$FULCRUM_HOST_USER)
  export FULCRUM_HOST_GID=$(stat -c %g /Users/$FULCRUM_HOST_USER)
  export FULCRUM_HOST_IP=$(ifconfig docker0 |grep 'inet addr'|cut -d: -f2|cut -d\  -f 1)
  export FULCRUM_DOCKER_COMPOSE="./docker-compose"

  export FULCRUM_DOCKER_PREFIX=""
  export FULCRUM_PATH=/Users/$FULCRUM_HOST_USER/fulcrum
  export FULCRUM_REPOS_PATH=/Users/$FULCRUM_HOST_USER/repos
  export FULCRUM_TMP_DIR=/tmp
fi
